<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jumppoint X 7-Eleven 自提點、自寄點查詢</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
<link rel="icon" href="https://cdn.prod.website-files.com/625fc6e7f6a0fbc4cd3a3246/6446da72e77910eee6b44c6d_jumppoint.svg" type="image/svg+xml">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background-color: #f9fafa;
    color: #383e71;
    margin: 20px;
  }
  .container {
    max-width: 1000px;
    margin: auto;
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: inset 0 0 60px 0 rgb(122 111 168 / 0.1);
  }
  .title-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px; /* logo 和文字間距 */
  margin-bottom: 20px; /* 下方空隙 */
}

.logo {
  width: 125px; /* 你可以根據需要調整大小 */
  height: auto;
}
  h2 {
    font-weight: 300;
    font-size: 32px;
    text-align: center;
    margin-bottom: 20px;
    color: #1246A0;
  }
  .lang-switch {
    text-align: center;
    margin-bottom: 20px;
  }
  .lang-switch button {
    background-color: #1467D6;
    color: #fff;
    border: none;
    border-radius: 7px;
    padding: 9px 22px;
    font-weight: 600;
    cursor: pointer;
    margin: 0 10px;
  }
  .lang-switch button:hover {
    background-color: #0D3B79;
  }
  #searchContainer {
    margin-bottom: 8px;
    text-align: center;
  }
    #searchInput,
  #regionButtons button,
  #districtFilter {
    padding: 10px;
    font-size: 1.1rem;
    border-radius: 8px;
    border: 1px solid #ccc;
    box-shadow: inset 0 0 12px rgb(76 136 225 / 0.15);
    margin-right: 8px;
    cursor: pointer;
  }
  #regionButtons button {
    display: inline-block;
    margin: 3px;
    border-radius: 7px;
    border: 1px solid #1467D6;
    background-color: white;
    color: #1467D6;
    font-weight: 600;
    min-width: 80px;
  }
  #regionButtons button.active {
    background-color: #1467D6;
    color: white;
  }
  #districtFilter {
    min-width: 150px;
  }
  .sort-hint {
    text-align: center;
    font-size: 14px;
    font-style: italic;
    color: #888;
    margin-bottom: 8px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    box-shadow: inset 0 0 15px rgb(81 94 153 / 0.15);
    border-radius: 10px;
    background: #fff;
    table-layout: fixed;
  }
  th,
  td {
    padding: 15px;
    text-align: center;
    border-bottom: 1px solid #d1dff5;
    font-weight: 400;
    font-size: 14px;
  }
   th {
    background-color: #d1daff;
    font-weight: 600;
    cursor: pointer;
    color: #1246A0;
    user-select: none;
  }
  th:hover {
    background-color: #b8ccff;
    color: #0d276b;
  }
  tr:hover {
    background-color: #cae0ff;
  }
  a {
    color: #1467D6;
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
  @media (max-width: 600px) {
    table,
    thead,
    tbody,
    th,
    td,
    tr {
      display: block;
    }
      tr {
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px #a5bbec;
      padding: 15px;
    }
    th {
      display: none;
    }
    td {
      position: relative;
      padding-left: 55%;
      padding-top: 10px;
      padding-bottom: 10px;
      border: none;
      border-bottom: 1px solid #d1dff5;
      text-align: right;
    }
    td:before {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 45%;
      font-weight: 600;
      color: #1246A0;
      white-space: nowrap;
      content: attr(data-label);
      font-size: 14px;
      text-align: left;
    }
  }
  #pagination,
  #paginationTop {
    margin: 15px 0;
    text-align: center;
  }
  #pagination button,
  #paginationTop button {
    margin: 0 3px;
    padding: 5px 12px;
    font-size: 14px;
    border-radius: 6px;
    border: 1px solid #1467D6;
    background: #fff;
    cursor: pointer;
  }
  #pagination button:disabled,
  #paginationTop button:disabled {
    background: #1467D6;
    color: #fff;
    cursor: default;
  }
</style>
</head>
<body>
<div class="container">
  <div class="title-container">
  <img src="https://cdn.prod.website-files.com/625fc6e7f6a0fbc4cd3a3246/6446da72e77910eee6b44c6d_jumppoint.svg" alt="Jumppoint Logo" class="logo" />
  <h2 id="title">Jumppoint X 7-Eleven 自提點、自寄點查詢</h2>
  </div>
  <div class="lang-switch">
    <button onclick="setLang('zh')">中文</button>
    <button onclick="setLang('en')">English</button>
  </div>
  <div id="searchContainer">
    <div id="regionButtons" style="margin-bottom: 8px;"></div>
    <select id="districtFilter" onchange="onDistrictFilterChange()" aria-label="District Filter"></select>
    <input type="text" id="searchInput" placeholder="搜尋區域、點碼或地址…" oninput="onSearchInputChange()" aria-label="Search Input"/>
  </div>
  <p class="sort-hint" id="sortHint">點擊表格標題即可排序 Click Header to Sort</p>
  <div id="paginationTop"></div>
  <table id="storeTable">
    <thead>
      <tr>
        <th onclick="sortTable(0)">區域 <span id="sort-arrow-0"></span></th>
        <th onclick="sortTable(1)">地區 <span id="sort-arrow-1"></span></th>
        <th onclick="sortTable(2)">自提點編號 <span id="sort-arrow-2"></span></th>
        <th>地址</th>
        <th>營業時間(週一至五)</th>
        <th>營業時間(週六)</th>
        <th>營業時間(週日及公眾假期)</th>
        <th>Phase</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
  <div id="pagination"></div>
</div>

<script>
  let data = [];
  let filteredData = [];
  let currentLang = 'zh';
  let currentSort = { col: null, ascending: true };
  let currentPage = 1;
  let currentRegionFilter = '';
  let currentDistrictFilter = '';
  let currentSearchTerm = '';
  const pageSize = 50;

  const regionLabels = {
    zh: ['', '九龍', '新界', '港島', '離島'],
    en: ['', 'Kowloon', 'New Territories', 'Hong Kong Island', 'Islands'] // 替換顯示
  };

  const tableHeaders = {
    zh: ['區域', '地區', '自提點編號', '地址', '營業時間(週一至五)', '營業時間(週六)', '營業時間(週日及公眾假期)', 'Phase'],
    en: ['Area', 'District', 'Pick up code', 'Address', 'Weekday Hours', 'Saturday Hours', 'Sunday & PH Hours', 'Phase'],
  };

  fetch('data.json')
    .then(res => res.json())
    .then(json => {
      data = json.map(item => {
        let areaEnRaw = item['區域']?.en || '';
        // 統一替換
        let areaEnFixed = (areaEnRaw.toLowerCase() === 'outlying islands') ? 'islands' : areaEnRaw;
        return {
          ...item,
          _areaEnFixed: areaEnFixed.toLowerCase(),
          mergedSearchText: (
            (item['中文地址'] || '') +
            (item['英文地址'] || '') +
            (item['區域']?.zh || '') +
            areaEnFixed +
            (item['地區']?.zh || '') +
            (item['地區']?.en || '') +
            (item['自提點編號 Pick up store code'] || '')
          ).toLowerCase(),
        };
      });

      setLang('zh'); // 預設中文並初始化UI
    });

  function setLang(lang) {
    currentLang = lang;
    currentRegionFilter = '';
    currentDistrictFilter = '';
    currentSearchTerm = '';
    currentPage = 1;
    document.getElementById('searchInput').value = '';
    document.getElementById('districtFilter').value = '';

    document.getElementById('title').innerText = lang === 'zh' ? 'Jumppoint X 7-Eleven 自提點、自寄點查詢' : 'Jumppoint X 7-Eleven Pickup Point Search';
    document.getElementById('searchInput').placeholder = lang === 'zh' ? '搜尋區域、點碼或地址…' : 'Search area, code or address...';

    updateRegionButtons();
    updateDistrictFilter();
    updateTableHeader();
    filterAndDisplay();
  }

  function updateRegionButtons() {
    const container = document.getElementById('regionButtons');
    container.innerHTML = '';
    regionLabels[currentLang].forEach(label => {
      let btnLabelCmp = label.toLowerCase() === 'outlying islands' ? 'islands' : label.toLowerCase();
      const btn = document.createElement('button');
      btn.textContent = label || (currentLang === 'zh' ? '全部區域' : 'All Regions');
      btn.className = (btnLabelCmp === currentRegionFilter || (label === '' && currentRegionFilter === '')) ? 'active' : '';
      btn.onclick = () => {
        currentRegionFilter = btnLabelCmp;
        currentDistrictFilter = '';
        currentSearchTerm = '';
        currentPage = 1;
        document.getElementById('districtFilter').value = '';
        document.getElementById('searchInput').value = '';
        updateRegionButtons();
        filterAndDisplay();
      };
      container.appendChild(btn);
    });
  }

  function updateDistrictFilter() {
    const select = document.getElementById('districtFilter');
    select.innerHTML = '';
    const allOption = document.createElement('option');
    allOption.value = '';
    allOption.textContent = currentLang === 'zh' ? '全部地區' : 'All Districts';
    select.appendChild(allOption);

    const districtsRaw = Array.from(new Set(data.map(d => d['地區'][currentLang]))).sort();
    districtsRaw.forEach(dist => {
      const option = document.createElement('option');
      option.value = dist.toLowerCase();
      option.textContent = dist;
      if (dist.toLowerCase() === currentDistrictFilter) option.selected = true;
      select.appendChild(option);
    });
  }

  function onDistrictFilterChange() {
    const select = document.getElementById('districtFilter');
    currentDistrictFilter = select.value;
    currentRegionFilter = '';
    currentSearchTerm = '';
    currentPage = 1;
    document.getElementById('searchInput').value = '';
    updateRegionButtons();
    filterAndDisplay();
  }

  function onSearchInputChange() {
    const input = document.getElementById('searchInput');
    currentSearchTerm = input.value.toLowerCase();
    if (currentSearchTerm !== '') {
      currentRegionFilter = '';
      currentDistrictFilter = '';
      updateRegionButtons();
      document.getElementById('districtFilter').value = '';
    }
    currentPage = 1;
    filterAndDisplay();
  }

  function filterAndDisplay() {
    filteredData = data.filter(d => {
      const areaZh = d['區域'].zh.toLowerCase();
      const areaEn = d._areaEnFixed || d['區域'].en.toLowerCase();
      const districtZh = d['地區'].zh.toLowerCase();
      const districtEn = d['地區'].en.toLowerCase();
      const merged = d.mergedSearchText;

      let regionMatch = true;
      if (currentRegionFilter) {
        regionMatch = (areaZh === currentRegionFilter || areaEn === currentRegionFilter);
      }

      let districtMatch = true;
      if (currentDistrictFilter) {
        districtMatch = (districtZh === currentDistrictFilter || districtEn === currentDistrictFilter);
      }

      let searchMatch = true;
      if (currentSearchTerm) {
        searchMatch = merged.includes(currentSearchTerm);
      }

      return regionMatch && districtMatch && searchMatch;
    });

    displayTable();
    displayPagination();
  }

  function displayTable() {
    const tbody = document.getElementById('tableBody');
    tbody.innerHTML = '';
    if (filteredData.length === 0) {
      tbody.innerHTML = `<tr><td colspan="8">${currentLang === 'zh' ? '無符合條件的資料' : 'No matching data'}</td></tr>`;
      return;
    }

    if (currentSort.col !== null) {
      filteredData.sort((a, b) => {
        let aVal, bVal;
        switch (currentSort.col) {
          case 0:
            aVal = a['區域'][currentLang];
            bVal = b['區域'][currentLang];
            break;
          case 1:
            aVal = a['地區'][currentLang];
            bVal = b['地區'][currentLang];
            break;
          case 2:
            aVal = a['自提點編號 Pick up store code'];
            bVal = b['自提點編號 Pick up store code'];
            break;
          default:
            aVal = '';
            bVal = '';
        }
        if (aVal < bVal) return currentSort.ascending ? -1 : 1;
        if (aVal > bVal) return currentSort.ascending ? 1 : -1;
        return 0;
      });
    }

    const start = (currentPage - 1) * pageSize;
    const end = start + pageSize;
    const pageData = filteredData.slice(start, end);

    pageData.forEach(row => {
      const tr = document.createElement('tr');
      const address = currentLang === 'zh' ? (row['中文地址'] || '') : (row['英文地址'] || row['中文地址'] || '');
      tr.innerHTML = `
        <td data-label="${currentLang === 'zh' ? '區域' : 'Area'}">${row['區域'][currentLang]}</td>
        <td data-label="${currentLang === 'zh' ? '地區' : 'District'}">${row['地區'][currentLang]}</td>
        <td data-label="${currentLang === 'zh' ? '自提點編號' : 'Pickup Code'}">${row['自提點編號 Pick up store code']}</td>
        <td data-label="${currentLang === 'zh' ? '地址' : 'Address'}"><a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}" target="_blank" rel="noopener noreferrer">${address}</a></td>
        <td data-label="${currentLang === 'zh' ? '營業時間(週一至五)' : 'Weekday Hours'}">${row['Mon-Fri (星期一至五開放時間)']}</td>
        <td data-label="${currentLang === 'zh' ? '營業時間(週六)' : 'Saturday Hours'}">${row['Sat (星期六開放時間)']}</td>
        <td data-label="${currentLang === 'zh' ? '營業時間(週日及公眾假期)' : 'Sunday & PH Hours'}">${row['Sun & PH (星期日及公眾假期開放時間)']}</td>
        <td data-label="Phase">${row['Phase']}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  function sortTable(colIndex) {
    if (currentSort.col === colIndex) {
      currentSort.ascending = !currentSort.ascending;
    } else {
      currentSort.col = colIndex;
      currentSort.ascending = true;
    }
    updateSortArrows();
    displayTable();
    displayPagination();
  }

  function updateSortArrows() {
    for (let i = 0; i <= 7; i++) {
      const arrow = document.getElementById(`sort-arrow-${i}`);
      arrow.textContent = i === currentSort.col ? (currentSort.ascending ? '▲' : '▼') : '';
    }
  }

  function updateTableHeader() {
  const headers = tableHeaders[currentLang];
  for (let i = 0; i < headers.length; i++) {
    const th = document.querySelector(`#storeTable th:nth-child(${i + 1})`);
    if (th) {
      th.innerHTML = '';
      th.appendChild(document.createTextNode(headers[i] + ' '));
      const arrowSpan = document.createElement('span');
      arrowSpan.id = `sort-arrow-${i}`;
      th.appendChild(arrowSpan);
      if (currentSort.col === i) {
        arrowSpan.textContent = currentSort.ascending ? '▲' : '▼';
      }
    }
  }
}

  function displayPagination() {
    const paginationBottom = document.getElementById('pagination');
    const paginationTop = document.getElementById('paginationTop');
    paginationBottom.innerHTML = '';
    paginationTop.innerHTML = '';
    const totalPages = Math.ceil(filteredData.length / pageSize);

    for (let i = 1; i <= totalPages; i++) {
      const buttonTop = document.createElement('button');
      const buttonBottom = document.createElement('button');

      buttonTop.textContent = i;
      buttonBottom.textContent = i;

      buttonTop.disabled = (i === currentPage);
      buttonBottom.disabled = (i === currentPage);

      buttonTop.onclick = buttonBottom.onclick = () => {
        currentPage = i;
        displayTable();
        displayPagination();
      };

      paginationTop.appendChild(buttonTop);
      paginationBottom.appendChild(buttonBottom);
    }
  }
</script>
</body>
</html>
